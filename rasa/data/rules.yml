version: "3.1"
rules:

# Saludo directo
- rule: Saludo
  steps:
    - intent: saludo
    - action: utter_saludo

# Iniciar formulario de soporte por cualquier problema técnico
- rule: Iniciar formulario de soporte (soporte_tecnico)
  steps:
    - intent: soporte_tecnico
    - action: soporte_form
    - active_loop: soporte_form

- rule: Iniciar formulario de soporte (otros_problemas)
  steps:
    - intent: otro_problema_tecnico
    - action: soporte_form
    - active_loop: soporte_form

- rule: Iniciar formulario de soporte (no_ingreso)
  steps:
    - intent: problema_no_ingreso
    - action: soporte_form
    - active_loop: soporte_form

- rule: Iniciar formulario de soporte (pantalla_blanca)
  steps:
    - intent: pantalla_blanca
    - action: soporte_form
    - active_loop: soporte_form

- rule: Iniciar formulario de soporte (error_actividad)
  steps:
    - intent: error_actividad
    - action: soporte_form
    - active_loop: soporte_form

# Submit del form de soporte
- rule: Enviar soporte tras completar form
  condition:
    - active_loop: soporte_form
  steps:
    - action: soporte_form
    - active_loop: null
    - action: utter_soporte_form_ok
    - action: action_enviar_soporte

# Flujo de recuperación de contraseña (form sólo email)
- rule: Iniciar recovery_form
  steps:
    - intent: recuperar_contrasena
    - action: recovery_form
    - active_loop: recovery_form

- rule: Submit recovery_form
  condition:
    - active_loop: recovery_form
  steps:
    - action: recovery_form
    - active_loop: null
    - action: action_enviar_correo
    - action: utter_confirmar_recuperacion

# Escalar a humano
- rule: Escalar a humano
  steps:
    - intent: escalar_humano
    - action: utter_escalar_humano