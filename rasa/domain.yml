version: "3.1"

intents:
  - saludo
  - explorar_temas
  - ingreso_zajuna
  - recuperar_contrasena
  - otro_problema_acceso
  - proceso_academico
  - ver_certificados
  - tutor_asignado
  - horarios_calendario
  - soporte_tecnico
  - problema_no_ingreso
  - pantalla_blanca
  - error_actividad
  - otro_problema_tecnico
  - escalar_humano
  - confirmacion_escalar_humano
  - negar_escalar
  - estado_estudiante
  - cambiar_idioma_ingles
  - cambiar_idioma_espanol
  - inscribirme
  - enviar_correo
  - auth_login
  - affirm
  - deny
  - fallback
  - enviar_soporte

entities:
  - email

slots:
  email:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: email
      - type: from_text
  nombre:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
  mensaje:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text

forms:
  soporte_form:
    required_slots:
      - nombre
      - email
      - mensaje
  recovery_form:
    required_slots:
      - email

responses:
  utter_saludo:
    - text: "Hola! ¿En qué puedo ayudarte hoy?"
      buttons:
        - title: "Explorar temas"
          payload: "/explorar_temas"
        - title: "Ingreso a Zajuna"
          payload: "/ingreso_zajuna"
        - title: "Mis cursos y contenidos"
          payload: "/explorar_temas"
        - title: "Proceso académico / administrativo"
          payload: "/proceso_academico"
        - title: "Soporte técnico"
          payload: "/soporte_tecnico"

  utter_cursos_carousel:
    - custom:
        cards:
          - title: "Excel Básico"
            subtitle: "20h - Virtual"
            image: "https://via.placeholder.com/300x160?text=Excel"
            buttons:
              - title: "Inscribirme"
                payload: "/inscribirme"
          - title: "Soldadura MIG"
            subtitle: "40h - Presencial"
            image: "https://via.placeholder.com/300x160?text=Soldadura"
            buttons:
              - title: "Inscribirme"
                payload: "/inscribirme"
          - title: "Programación Web"
            subtitle: "60h - Virtual"
            image: "https://via.placeholder.com/300x160?text=Web"
            buttons:
              - title: "Inscribirme"
                payload: "/inscribirme"

  utter_cursos_recomendados:
    - text: "Aquí tienes algunos cursos que podrían interesarte:"
      buttons:
        - title: "Python Básico – Ago 2025"
          payload: "/inscribirme"
        - title: "IA Educativa – Sep 2025"
          payload: "/inscribirme"

  utter_preguntar_problema_acceso:
    - text: "Entiendo. ¿Tienes problemas de acceso? ¿Deseas recuperar tu contraseña?"
      buttons:
        - title: "Sí, recuperar contraseña"
          payload: "/recuperar_contrasena"
        - title: "No, otro problema"
          payload: "/otro_problema_acceso"

  utter_pedir_correo:
    - text: "Por favor, dime tu correo para enviarte el enlace de recuperación."

  utter_confirmar_recuperacion:
    - text: "Perfecto. Revisa tu bandeja de entrada."

  utter_menu_proceso_academico:
    - text: "¿Sobre qué deseas información?"
      buttons:
        - title: "Tutor asignado"
          payload: "/tutor_asignado"
        - title: "Certificados"
          payload: "/ver_certificados"
        - title: "Horarios y calendario"
          payload: "/horarios_calendario"

  utter_certificados_info:
    - text: |
        Python Básico – Nov 2024
        IA Educativa – Ene 2025
      buttons:
        - title: "Descargar todos"
          payload: "/ver_certificados"
        - title: "Ver detalles"
          payload: "/ver_certificados"

  utter_tutor_asignado:
    - text: |
        Tu tutor actual es:
        Nombre: Prof. Ana María Restrepo
        Email: ana.restrepo@zajuna.edu
        Horario: Lun y Mié 10:00 - 12:00
      buttons:
        - title: "Ver disponibilidad"
          payload: "/tutor_asignado"
        - title: "Enviar mensaje"
          payload: "/tutor_asignado"

  utter_soporte_tecnico:
    - text: "Entiendo. Vamos a tomar tus datos para ayudarte mejor."

  utter_estado_estudiante:
    - text: "Estás activo para el periodo académico 2025-2."

  utter_cambio_idioma_ingles:
    - text: "Sure! Let's switch to English. You can ask me anything about your academic process or technical issues."

  utter_cambio_idioma_espanol:
    - text: "Volvamos a Español."

  utter_escalar_humano:
    - text: "¿Quieres que te comunique con un agente humano?"
    - buttons:
        - title: "Sí, por favor"
          payload: "/confirmacion_escalar_humano"
        - title: "No, seguir con bot"
          payload: "/negar_escalar"

  utter_confirmar_escalado:
    - text: "Te estoy conectando con un agente humano, por favor espera..."

  utter_gracias_continuar:
    - text: "Perfecto, sigamos aquí en el chat."

  utter_confirmacion_inscripcion:
    - text: "Estás inscrito al curso. Te enviaremos confirmación por correo."

  utter_default:
    - text: "No entendí eso. ¿Podrías reformularlo?"

  # Prompts del soporte_form
  utter_ask_nombre:
    - text: "¿Cuál es tu nombre completo?"
  utter_ask_email:
    - text: "¿Cuál es tu correo de contacto?"
  utter_ask_mensaje:
    - text: "Cuéntame brevemente el problema técnico (máx. 5000 caracteres)."

  utter_soporte_form_ok:
    - text: "Gracias. Estoy registrando tu solicitud..."

  utter_soporte_resumen:
    - text: |
        Gracias {nombre}. Voy a crear un ticket con:
        - Email: {email}
        - Mensaje: "{mensaje}"

  utter_soporte_creado:
    - text: "Ticket creado correctamente. Te enviaremos novedades a tu correo."

  utter_soporte_error:
    - text: "Ocurrió un error al crear el ticket. Intenta de nuevo en unos minutos."

  utter_need_auth:
    - text: "Necesitas iniciar sesión para ver esta información."
      buttons:
        - title: "Iniciar sesión"
          payload: "/auth_login"
      custom:
        type: "auth_needed"
        message: "Necesitas iniciar sesión para continuar."

  # Confirmación breve usada por regla 'Enviar soporte directo'
  utter_soporte_confirm:
    - text: "Listo. He enviado tu solicitud de soporte. Te contactaremos al correo indicado."

actions:
  - action_enviar_correo
  - action_conectar_humano
  - action_soporte_submit
  - action_enviar_soporte
  - validate_soporte_form
  - validate_recovery_form
  - action_check_auth
  - action_health_check

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true