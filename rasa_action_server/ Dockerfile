# rasa_action_server/Dockerfile
FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1

WORKDIR /app/actions

# 1) Instala rasa-sdk (servidor de acciones)
RUN pip install --no-cache-dir rasa-sdk==3.6.2

# 2) (Opcional) si tienes dependencias de acciones:
#    crea "rasa/actions/requirements.txt" y se instalarán aquí
COPY rasa/actions/requirements.txt /tmp/requirements.txt
RUN if [ -f /tmp/requirements.txt ]; then \
      pip install --no-cache-dir -r /tmp/requirements.txt; \
    fi

# 3) Copia SOLO el código de acciones
COPY rasa/actions /app/actions

EXPOSE 5055
CMD ["python", "-m", "rasa_sdk", "--actions", "actions", "--port", "5055"]